#+TITLE: lan-mouse switch
#+AUTHOR: Rafael Ito
#+PROPERTY: header-args :tangle lanmouse-switch_laptop.sh
#+DESCRIPTION: script to swap keeb/mouse between hosts via lan-mouse software switch KVM
#+STARTUP: showeverything
#+auto_tangle: t

* Table of Contents :toc_3:
- [[#header][Header]]
- [[#toggle][Toggle]]
- [[#right][Right]]
- [[#left][Left]]

* Header :noexport_1:
** Shebang
#+begin_src sh
#!/usr/bin/env bash
#+end_src
** Help menu
#+begin_src sh
# Usage:
# ./lanmouse-switch.sh toggle
# ./lanmouse-switch.sh left
# ./lanmouse-switch.sh right
# ./lanmouse-switch.sh last
#+end_src
** Description
#+begin_src sh
# alternative to ydotool: wlrctl
# eg: "wlrctl pointer move -9999 -9999"
#
# !!! I don't know why, but when using "ydotool mousemove", the coordinates required are dividing by 2 !!!
#+end_src
** Outputs
#+begin_src sh
OUTPUT_CENTRAL="HDMI-A-1"  # primary
OUTPUT_LEFT="DP-1"         # secondary
OUTPUT_RIGHT="DVI-I-1"     # tertiary
#+end_src
** Parse parameters
#+begin_src sh
COMMAND="$1"
case "$COMMAND" in
#+end_src
* Toggle
#+begin_src sh
"toggle")
    # [local]
    ydotool mousemove -x 9999 -y 9999   # bottom right
    ydotool mousemove -x -480 -y -9999  # top middle
    # [remote]
    #ssh catuaba "ydotool mousemove -x -9999 -y -9999 && ydotool mousemove -x 1440 -y 270"
    ssh catuaba "export SWAYSOCK=\$(ls /run/user/$(id -u)/sway-ipc.*.sock | head -n 1); swaymsg focus output $OUTPUT_CENTRAL" > /dev/null
    ;;
#+end_src
* Right
#+begin_src sh
"right")
    # [local]
    ydotool mousemove -x 9999 -y 9999   # bottom right
    ydotool mousemove -x -480 -y -9999  # top middle
    # [remote]
    #ssh catuaba "ydotool mousemove -x -9999 -y -9999 && ydotool mousemove -x 2190 -y 480"
    ssh catuaba "export SWAYSOCK=\$(ls /run/user/$(id -u)/sway-ipc.*.sock | head -n 1); swaymsg focus output $OUTPUT_RIGHT" > /dev/null
    ;;
#+end_src
* Left
#+begin_src sh
"left")
    # [local]
    ydotool mousemove -x 9999 -y 9999   # bottom right
    ydotool mousemove -x -480 -y -9999  # top middle
    # [remote]
    #ssh catuaba "ydotool mousemove -x -9999 -y -9999 && ydotool mousemove -x 480 -y 270"
    ssh catuaba "export SWAYSOCK=\$(ls /run/user/$(id -u)/sway-ipc.*.sock | head -n 1); swaymsg focus output $OUTPUT_LEFT" > /dev/null
    ;;
#+end_src
* EoS :noexport:
#+begin_src sh
esac
#+end_src
